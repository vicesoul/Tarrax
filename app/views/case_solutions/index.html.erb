
<% js_bundle :case_solution_index %>
<% unless @case_solutions.empty? %>
  <div>
    <% form_for @search, :url => course_case_issue_case_solutions_path do |f| %>
      <div>
          <ul>
            <li>
              <label><%= t 'selector.subject', 'Title' %>:</label>
              <%= f.text_field :title_like %>
            </li>
            <li>
              <label><%= t 'selector.author', 'Author' %>:</label>
              <%= f.text_field :user_name_like %>
            </li>
            <li>
              <label><%= t 'selector.state', 'State' %>:</label>
              <%= f.check_box :workflow_state_in, {:name => "search[workflow_state_in][]"}, 'executing', nil %> <%= t '', 'Executing' %>
              <%= f.check_box :workflow_state_in, {:name => "search[workflow_state_in][]"}, 'being_reviewed', nil %> <%= t '', 'Being reviewed' %>
              <%= f.check_box :workflow_state_in, {:name => "search[workflow_state_in][]"}, 'reviewed', nil %> <%= t '', 'Reviewed' %>
              <%= f.check_box :workflow_state_in, {:name => "search[workflow_state_in][]"}, 'recommended', nil %> <%= t '', 'Recommended' %>
            </li>
            <li>
              <label> </label>
              <%= f.submit t('selector.query', 'Query'), {:class => "btn btn-primary"} %>
            </li>
           </ul>
      </div>
    <% end %>
  </div>
  <%= pagination = will_paginate(@case_issues) %>
  <div>
    <h1>
      <%= @case_solutions[0].case_issue.subject %>
    </h1>
  </div>
  <table class="table table-striped table-bordered">
    <thead>
      <tr>
        <th><%= sortable_for_searchlogic('title', (t '', 'Title')) %></th>
        <th><%= sortable_for_searchlogic('workflow_state', (t '', 'State')) %></th>
        <th><%= sortable_for_searchlogic('group_discuss', (t '', 'Group Discuss')) %></th>
        <th><%= sortable_for_searchlogic('name', (t '', 'Author'), 'user_sort_by_custom') %></th>
        <th><%= sortable_for_searchlogic('updated_at', (t '', 'Updated At')) %></th>
        <th><%= t '', 'Operation' %></th>
      </tr>
    </thead>

    <% @case_solutions.each do |case_solution| %>
      <tr>
      <td><%= case_solution.title %></td>
      <td><%= case_solution.workflow_state %></td>
      <td><%= case_solution.group_discuss ? 'yes' : 'no' %></td>
      <td><%= case_solution.user.name %></td>
      <td><%= case_solution.updated_at.to_formatted_s(:db) %></td>
      <td>
        <% if case_solution.executing? && can_do(@context, @current_user, :operate_case_as_student) && case_solution.user.id == @current_user.id %>
          <%= link_to (t '', 'Submit'), course_case_issue_case_solution_submit_path(@context, params[:case_issue_id], case_solution), {:class => 'solution-submit'} %> |
        <%= link_to 'Edit', edit_course_case_issue_case_solution_path(@context, params[:case_issue_id], case_solution) %> |
        <%= link_to 'Delete', course_case_issue_case_solution_path(@context, params[:case_issue_id], case_solution), :confirm => 'Are you sure?', :method => :delete %>
      <% end %>
        <% if case_solution.being_reviewed? && can_do(@context, @current_user, :operate_case_as_teacher) %>
          <%= link_to (t '', 'Review'), course_case_issue_case_solution_review_path(@context, params[:case_issue_id], case_solution), {:class => 'solution-review'} %>
      <% end %>
      </td>
    </tr>
  <% end %>
  </table>
  <%= pagination %>
<% else %>
  <%= t '', 'Empty case solutions' %>
<% end %>

<div id="case-review-dialog" style="display:none">
  <%= t '', 'Your option is' %>
  <input type="radio" name="review_result" value="review" checked="true"><%= t '', 'Review' %>
  <input type="radio" name="review_result" value="recommend"><%= t '', 'Recommend' %>
</div>
